# ğŸš€ Cloudflare Workers æç®€åšå®¢æ­å»ºæ•™ç¨‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Cloudflare Workers + KV + é™æ€èµ„æºç»‘å®š** æ„å»ºçš„è½»é‡çº§åšå®¢ç³»ç»Ÿã€‚å®ƒå…·å¤‡é«˜æ€§èƒ½ã€é›¶æˆæœ¬æ‰˜ç®¡ä»¥åŠå¼ºå¤§çš„åœ¨çº¿ç®¡ç†åŠŸèƒ½ã€‚

---

## **1. æŠ€æœ¯æ¶æ„**
- **åç«¯**: Cloudflare Workers (JavaScript / Module Worker)
- **å­˜å‚¨**: 
  - **ASSETS**: å­˜æ”¾ CSSã€å›¾æ ‡ã€åˆå§‹æ–‡ç« ç­‰é™æ€æ–‡ä»¶ã€‚
  - **KV (Key-Value)**: å­˜å‚¨åŠ¨æ€æ–‡ç« ã€ç”¨æˆ·è¯„è®ºã€å›¾ç‰‡ç´¢å¼•ã€‚
- **å‰ç«¯**: åŸç”Ÿ HTML/CSS + Marked.js + Highlight.jsã€‚

---

## **2. ç¯å¢ƒå‡†å¤‡**

1. **å®‰è£… Node.js**: ç¡®ä¿å·²å®‰è£… Node.js ç¯å¢ƒã€‚
2. **å®‰è£… Wrangler**: 
   ```bash
   npm install -g wrangler
   ```
3. **ç™»å½• Cloudflare**:
   ```bash
   wrangler login
   ```

---

## **3. å¿«é€Ÿå¼€å§‹**

### **æ­¥éª¤ Aï¼šåˆå§‹åŒ–é¡¹ç›®**
```bash
git clone https://github.com/jams-peter-cloud/blog.git
cd blog
npm install
```

### **æ­¥éª¤ Bï¼šé…ç½® `wrangler.toml`**
ä½ éœ€è¦åˆ›å»ºä¸‰ä¸ª KV å‘½åç©ºé—´ï¼Œå¹¶å°†å…¶ ID å¡«å…¥ `wrangler.toml`ï¼š

```toml
name = "blog"
main = "src/worker.js"
compatibility_date = "2024-02-24"

# é™æ€èµ„æºç›®å½•
assets = { directory = "./public", binding = "ASSETS" }

# KV å‘½åç©ºé—´ç»‘å®š
[[kv_namespaces]]
binding = "POSTS"
id = "ä½ çš„_POSTS_KV_ID"

[[kv_namespaces]]
binding = "COMMENTS"
id = "ä½ çš„_COMMENTS_KV_ID"

[[kv_namespaces]]
binding = "IMAGES"
id = "ä½ çš„_IMAGES_KV_ID"

[vars]
ADMIN_TOKEN = "123456" # ç”¨äºè¿›å…¥ IDE åå°çš„ä»¤ç‰Œ
```

---

## **4. æ ¸å¿ƒåŠŸèƒ½**

### **âœ¨ åœ¨çº¿ IDE ç®¡ç†åå°**
è®¿é—®åœ°å€ï¼š`ä½ çš„åŸŸå/ide/build?token=ä½ çš„ä»¤ç‰Œ`
- **å®æ—¶é¢„è§ˆ**: å·¦ä¾§ç¼–è¾‘ Markdownï¼Œå³ä¾§å®æ—¶æ˜¾ç¤ºæ•ˆæœã€‚
- **æ»šåŠ¨åŒæ­¥**: ç¼–è¾‘å™¨ä¸é¢„è§ˆåŒºæŒ‰ç™¾åˆ†æ¯”åŒæ­¥æ»šåŠ¨ã€‚
- **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒæ‹–æ‹½ `.md` æˆ–å›¾ç‰‡æ–‡ä»¶ç›´æ¥å‘å¸ƒã€‚

### **âœ¨ ç‰¹æ®Šè¯­æ³•æ”¯æŒ**
æ”¯æŒ `'''` è¯­æ³•åŒ…è£¹åŸå§‹ä»£ç æˆ–æ–‡æœ¬ï¼Œé˜²æ­¢ Markdown è§£æå¹²æ‰°ï¼š
```text
'''python
print("è¿™æ®µä»£ç ä¼šä¿æŒåŸæ ·å¹¶é«˜äº®")
'''
```

### **âœ¨ æ™ºèƒ½æ–‡ç« åŠ è½½**
ç³»ç»Ÿä¼šåŒæ—¶ä» `public/posts/` (é™æ€) å’Œ `KV` (åŠ¨æ€) ä¸­è¯»å–æ–‡ç« ï¼Œå¹¶è‡ªåŠ¨åˆå¹¶å»é‡ï¼ŒKV ä¸­çš„ä¿®æ”¹å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§ã€‚

---

## **5. éƒ¨ç½²å‘½ä»¤**

### **æœ¬åœ°å¼€å‘è°ƒè¯•**
```bash
wrangler dev
```

### **éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ**
```bash
wrangler deploy
```

---

## **6. å¸¸è§æ’æŸ¥**

- **æ–‡ç« ä¸æ˜¾ç¤º**: æ£€æŸ¥ `public/posts.json` æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œæˆ–è€… KV ç»‘å®šæ˜¯å¦æˆåŠŸã€‚
- **IDE éªŒè¯å¤±è´¥**: ç¡®ä¿ URL ä¸­çš„ `token` ä¸ `wrangler.toml` ä¸­çš„ `ADMIN_TOKEN` ä¸€è‡´ã€‚
- **ä»£ç ä¸é«˜äº®**: æ£€æŸ¥ `worker.js` ä¸­ `cdnjs` çš„ `highlight.js` é“¾æ¥æ˜¯å¦åŠ è½½æˆåŠŸã€‚

---
Â© 2026 åŸºäº Cloudflare æ„å»ºçš„æé€Ÿåšå®¢ç³»ç»Ÿã€‚
